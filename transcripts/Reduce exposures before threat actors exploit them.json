{
    "title": "Reduce exposures before threat actors exploit them",
    "presentation_type": "Breakout",
    "categories": [
        "Security Professionals",
        "SEC209"
    ],
    "video_id": "rhaJWwhtDwA",
    "time": "Aug 31 12:15 PM - 01:00 PM CDT",
    "transcript": "foreign[Music]thanks everybody for coming it was aThursday everyone probably had a few toomany drinks at the LL Cool J but youguys made it you guys were responsiblethat is awesomeumI'm curious we're just having thisdiscussion we know that next is a GoogleCloud show and everyone's you know I.Tprofessionals and security is everyone'sresponsibility but how many people herewould self uh describe yourself as asecurity professionaloh wow okay how many are vendorsyeahwe like those vendors so they canum well that's awesome sothis is not going to be super structureduh Tim is here he's going to kind ofshare a lot about what he's gone throughas uh ciso of mandian and kind of how heapproaches a job we have this microphonethat's right here it's a real handsomemicrophone if you would like to askquestions at any point feel free to comeon up and we'll make a discussionbecause you know we're all friends nowwe've done Google next togetherso sound goodremember group participation we're allin it together all right I'll sit downyou can always tell the marketing folkscan't youI'm a technical professional myself letme switch this slide[Laughter]or notactually we don't actually even that wedon't need a slight switchsorry let's see if we goall right so one of the things whichumin my you know vast years of doing thisuh I was doing research was there's a Idon't know how many of you guys arefamiliar with VX Undergroundso it's a place where you know people uhthrow up malware and discuss what'sgoing on in cyber security my favoritequote about mandian is from uhransomware operator out of uh EasternEurope he says I don't fear the FBII fear mandian and he he kind of tellsthis whole story about howum you know the reason he hasn'tprobably been retired yet is because youknow we've intervened in some of hisransomware operationsum what it does for us I think it putsus as a Targetand so you being the person probably whois feeling the brunt of that maybe maybetalk about your experience beingseasoned yeah sure so as always I youknow I would stress it's a team effortright the the uh I'm point but uh it'sreally really about what the team doesthe way I like to describe it is uh wehave the best of the worst after us andum which is fun challenge you know uhfor us as Defenders at least uh one ofmy favorite stories of an example thereum at least I think it's humorous as aDefender is we've got an actor that'sbased out of uh you know one of theRussian cities we we actually know wherehe is ETC because he's been doxed byother underground folks and we were ableto validate but uh the group he's partof was behind several Big Brandsomewhere incidents and uh later on wewere in a situation where uh ourConsulting team was able to help acouple customers had them off so he wenton the Underground forums posting thatme Indian has stolen five milliondollars from him because in his logichad we not intervened uh he would havebeen five million dollars richer so uhso that's that's I think a little bit ofthe glimpse of of what it's likeum but yeah you know the from myperspective there's a bunch of thingsthat we as Defenders have that I oftensee in talking to peers that we're we'renot taking advantage of as much as we uhwe can uh and that we certainly do uhone of those is we really have a homefield advantage right you know if youthink about it from our perspectiveone thing that we have that we canleverage against the attacker and weobviously as we talk here this morningwe can talk a little bit more aboutdetails but we have the ability tocreate an environment that is verydifficult for them to navigate and veryrich for us to find them trying tonavigate itum because they can't know ourenvironment until they get into it rightand and taking that and leveraging thatagainst them is especially you know youthink about this year where we've seenjust uh uh preponderance of ode uhexploits used right the the certainlythe uh what Kevin likes to refer to asthe apex predators uh you know the thetop nation-state acting groups forinstance and the type top cyber criminalacting groupsthey're going to be able to at least geta foothold in our environmentum but that's where I think thinkingabout defense a little more largelyright well we can't necessarily stopthem obviously we want to try as much aspossible from getting that foothold wecan prevent them from getting one oftheir objective is right you know if ifit's Monday morning the blood level inmy caffeine system is a little too highright I click on that malicious link andnow I've got malware running in mylaptopwell that's that's not the objectiveright that that adversary isn't goingfor me personally I'm a means to an endright I'm a way to get to whatever it isthat they're looking to to accomplishand so when we think about breachprevention I think in that context thatreally changes how we go aboutprioritizing our defenses and and wherewe put them well let's talk about hotzero day summersoyou know I was talking to one of ourprofessionals yesterday who actuallypresentedum I think we're at 54 zero days so farin the year we obviously have somemonths leftum if we had looked and done this studyjust even recently it was a couple yearsago I think the number one vector forattacks would be fishingwe're clearly seeing a known and unknownvulnerabilities being the by far the theway people are getting in nowum how does that change our approachlike for example with the zero day likewhat can be done about that well so withthe zero day we're not going to be ableto prevent the you know the that initialfoothold right if a zero day bydefinition is an exploit that we don'tknow about that nobody knows about uhthat exists but remember that's just thefirst step when they deploy that zeroday again that's the first step in asequenceum and and so I'll give you a specificexample uh that I know Kevin is referredto a lot we had a defense industrialcontractor that uh we're prettyconfident it was uh you know uh Mandarinspeaking actors behind it they deployedover the course of that uh you knowattackum three separate o days as well asdeploying a previously unknown uh Nativemalware framework that ran natively inthe ESX hypervisor rightand and I think it's important for usthough this is where threat Intel oneexample of where threat Intel becomes socritically important for us as Defendersbecause the devil is in the detailsthere rightso one of the other things that I thinkis super important for us as Defendersis to keep hyper focused on thefundamentals right so when I say thefundamentals I mean things like Risksurface right are we running things thatwe don't need to be running zero trustarchitecture to Factor on on all thethings Etc rightum having those fundamentals and havingthose applied you know I frankly there'snothing more important than that and inthis example what happened was there wasa uh zero day against their externallyfacing firewall the actor then used thatdeployed a zero day of wins one of theircore routers from there was able to thenpivot and use the node to get into theiruh ESX environmentthe middle piece is kind of importantbecause when you looked at the detailsfor the zero day it was in a protocolcalled SNMP uh simple Network managementprotocol uh often we don't use thatnowadays it's an old old protocol rightcertainly still occasionallybut a goodie that's rightum but in this organization's case theyweren't using SNMP so had they disabledSNMP risk surface reduction because theyweren't enabling it that would haveprevented the threat actor from beingable to to leverage that that particularouting now of course they could haveleveraged another one et cetera rightbut but I think there's an example wherethe fundamentals even in the day of Odays can can really uh make a differencefor inhibiting the progressum VMware did not have two Factor on itand again that was part of what theywere able to leverage you know as partof that sequence soum yeah I think even when the day ofOdes now of course on the flip side Danwe can also then talk about how do weuse our environment against them rightand the the core thing is really simpleumthe attackers inevitably look differentin the environment than our real usersdo because of course they have differentintent that they're trying to accomplishso for instance uh what we've doneinside mandian is we built customdetection around all of those differentkey areas right so we know exactly whatit looks like for the admins to beinteracting with those core routers forinstance and when interaction occursthat's outside of that that same patternthen we have somebody taking a lookright uh we I'm a huge fan of deceptiontooling specifically honey tokens what'swhat's called honey tokens now right wethink about again the needs of theattacker they're going to need to movelaterally around within our environmentwell of course the primary thing they'regoing to accomplish that is they'regoing to dump whatever credentials arein the systems that they've compromisedso they can use those credentials thoseauthentication tokens Etc on subsequenthosts right well if we have plantedbogus ones now they've got to lookincredibly real rightum you've got to do it well but but it'spretty straightforward to deploy just awhole bunch of effectively what I wouldsuggest are landmines uh throughout theenvironment and all we need is for themto bump into one of those and and nowwe're in a race condition where it'sit's defense against offense get themout before they complete whatever thatobjective that they've got in mind Imean I think the Trope is assuming andwe were the ones who probably also kindof said this assume you're alreadycompromised right and then what are allthe ways you can make it harder as theyget there you're kind of describing zeroyou know zero trust uh two baggedauthentication the honey pots justanything we can to prevent the lateralspread what what about in terms of whatyou do in the sock maybe talk about whatthe sock looks like how do you detectthese anomalies how do you detect theevents and then how do you guys thinkabout investigation yeah that's a greatquestion so so weif you look at a typical sock and what'sgoing to Glass it's a lot of informationabout attackswell if we have built our our system soso we optimize for containment soaverage containment time out of our teamis about 12 minutes uh currently so thatmeans from the point at which we have uhfigured out that we have we call it aprevention failure uh somewhere withinthe environment on average it takesabout 12 minutes to eject uh whateverthat offending uhissue is right so when we've becausewe've optimized for that then thatallows you to start thinking about whatyou send to Glass very differently uhbecause uh we don't really care aboutattacks we we do of course but that'sreally more valuable for our Intel teamto be understanding that for the actualsock team we care about successfulattacks and and when you start thinkingabout the ramifications of that andstart digging in you realize well wait aminute some of the best indicatorsaren't necessarily the attack stuffright for instance if we see say analert that an endpoint agent cleans somemalware off of a hose that's a greatindicator of a possible preventionfailure in progress right because eventhough it's cleaned some level ofmalware one it might not have gotteneverything two we really want tounderstand how to malware get to thathost in the first place right becausethat shouldn't even be possible with thethe prevention and with securitycontrols and the supply chain attackswe're seeing it's not like you're goingto putan EDR and like at the firewall likewell you can't right and and andcertainly the sophisticated attackersunderstand that EDR is only able to runon your servers and your endpoints rightum EDR doesn't exist for your coreswitches EDR doesn't exist for yourfirewall probablyum you know unless you're doing a pfsetsfirewall or something like thatum bottom line isum you know they know that part of theirmethodology is to what we commonly referto as living off the land and leverageour environment against us right butagain that that just goes back to why Ithink it's so important to plant thoselandmines well I think when you likethis I know we've well documented thisotherwise attack and how it wasdiscovered but maybe we talk about thatbecause this is a case where againsomeone gets in through supply chainyou're looking for Behavior like youtalked about that's unusual from thenormal user yeah can you tell that storyabout it so so I think what often getsmissed in our explaining what happenedwith solar winds it was not a technicalcontrol uh technology at all that thatwas provided that first uh indication itwas a manual process uh so insidemandian of course we use two-factor onall of our stuffif ever uh anytime a person adds anadditional phone to their two-factor wehave a manual process where our sockcalls them to validate that it was veryhard to log into anything guys but it'svery productivewe try and strike that balance we onlymake you we only make you awesome Igotta I gotta enter a code in right nowwe only we only make you off like 50 60times a day come on it's not that badit's really not that bad it does not butbut but that's where I think againthinking about I I guess you know redteam in particular is from myperspective our best friends you know wewere just talking about the sockum you know what we now call commonlypurple teaming is just incrediblyvaluable right so so we uh we'refortunate to have you know one of thethe best red teams on the planetwe have a significant red team mop everysingle month so we plan these of courseout out several months in advance butthen generally the way it works out isthere's a couple weeks where the redteam is focused on their objective thenthe last couple weeks of that month itflips into a purple team engagementwhere they're cooperating and and andworking together and then of coursecouple weeks later we'll get we'll getthe readout on on the exercises and suchum but that is again uh an incredibleum you know it all comes back to threadIntel from my perspective right thebetter I understand as a Defender thethreat actors the better I can get intheir head understand theirmethodologies understand theirapproaches the better I can subvertthose approaches that's why I think myred team goes they think about who wouldbe attacking Mandan absolutely ton ofresearch on the attack vectors thetechniques they normally use and thenthey build a plan just to beat us howhow successfulyeah they're very successful at gettingfootholdsum they're uh uh yeah we intentionallyuh most of our engagements give themassumed foothold because we don't wantto take the time although at least oncea year we do uh No Holds Barred oh yeahcan you find a foothold any way meanshape possible because again the thethreat actors will do that right uh sowe we can't tie the hands of the redteam every time if we truly want yes whoin our caseum uhobviously we have a customer facingIntel team that that's leveraged for ourour customer work but we also have adedicated separate Intel team thatreports as part of my team their job istoingest all of that threat Intel fromacross nowadaysum uh larger Google Cloud not justmandia so all of the threat Intel fromall of the sources that we can getand figure out what if that is relevantto us so so we maintain on an ongoingbasis it's almost like aForester wave or a Gartner you know toptechnology report in that what we'redoing is we're rating the threat actorson two Dimensions who has demonstratedinterest in harming mandia and who hasthe capabilities to potentially get pastthe level of of prevention and controlsthat we have and so what that does iswe've got then the top 10 threat actorsfor us and of course that becomes ourtop priority so so we then trackeverything those actors do all the timeany little bit of change we immediatelythen go look well can we prevent it canwe detect it do we need some customdetection in place in order to do thatand then we're continuing so the pageone of that report is here's who thoseactors are then page two is an ongoinganalysis of red yellow green how wellour our prevention detection andcapabilities are against that and thenwe even go further and do things like webuild out uhvirtual machines with uh using the thetechniques of those threat actors so itlooks just like they were compromised bythose threat actors so then our sockfolks can investigate on those platformsand really understand how to how to goafter and and and follow those up rightand and this sounds like it's a lot ofwork but really what it is is it's aprioritization effort rightum at the end of the daywe can't have all the controls andeverywhere you know joking aside we'vegot real work to get done we need realmarketing budget so we can't puteverything into the office of the CSOum but but I would be curious thoughlike so and I think it's probably foreveryone you know you you have access toall these expertsum how many people here have uhthreat intelligence team as part oftheir security group so pretty goodamount that's a good amountumhow do you you know if you have asmaller team you don't have access toexperts like what what are the thingsyou do obviously prioritizing focusingon certain threat actors and the oneswho are most active is important whatare some other yeahif you don't have a a dedicated threatIntel even considering you know doingpart-time out of your sock folks andthings like that is is a great way tostart only because one that gives themsome variety and and allows them toexpand out their capabilities butum but it's really ultimately I I lookat threat Intel as a tool forprioritization at the end of the day soif if I don't have uh those then I I'm ahuge fan of of peers I I have a prettysignificant Networkum I go talk to friends right hey whatare you all doing what are you allseeingum there's also just a ton of um youknow when you look at the like the iceacts and things like that most of theISAC groups there's the official ISACchannels and then there's the unofficialISAC channels right where because we'vegot likedesires interests you know Etc maybethere's some private slack channels orwhat have you right where where we sharea lot of this stuff before you know oneof the thingsum so prior to coming back to mandianuh I spent six and a half years I I wasat Mandy and went to Target in 2014helped rebuild their program after theirbreach in 2013 spent six and a halfyears there retail is a great examplewhere you know uh Walmart and Target aremortal enemies uh you know in industrybut their cyber security teams arehugely collaborative and share all ofthose you know and and there's certainthings where I think we as industry haveto take that mature view where we canhave all sorts of competition and needto for business purposes but there'scertain thingsum you know like operating in Cloud I amabsolutely open to sharing with ourcompetitors on cyber security right wegot to have very firm boundariesobviously uh and guardrails here butyou know one of our competitors having abad security day hurts all of cloud notnot just that competitor right this bagis the question which uh Isaac verticalis the best Tang is it the retail groupis it the tech security group uh I don'tknow that's a good question I had toplay poker with on TuesdayI'm going to plead the fifth on thatquestion I'm just going to get myself introuble got some questions feel free tocome on yeah please please ask questionsyou talked aboutum hey we have this defender's Advantagebecause we should know our stuff yeahI would argue that probably we have alot of I.T sprawl I think one of the bigchallenges everyone has like what areall the things we have yeah how do youguys take that approach well I that's agreat question I think that's where youknow being realistic with some carcompartmentalization and things likethat right uh you know I worked at GE atone point in my career right and youknow for very understandable businessreasons uh when I was there in early2000 teens they had they were stillrunning Windows 95 boxes right and thisis 2010 2011 here we're talking aboutbecause it was running some bespokemanufacturing robot software on anassembly line and it you know it costmillions of dollars to implement itstill worked perfectly fine great butlet's wall those off they don't needconnectivity to the larger environmentand and so that's where things like thezero trust architecture really come intoplay right um it sprawl is absolutelygoing to happenum and and as a reality and we we can'teffectively defend if we don't make thatpart of our plan uh and account for itbut how we're going to account for it isabsolutely going to be dependent on theorganization and those specifics how doyou think about external attack surfaceDiscovery and that approachum again if if uhnot knowing that you've got to exposedthing is no excuse to having a breachright uh we all know that the threatactors are using the showdowns and allthe the Myriad tools they have availableto them to find gapsum and so many so much of this stuff isagain just well-meaning people trying todo their day jobs uh you know or youknow where I see a lot of problems onexternal is um not to poke a little funat the marketing but you you go out andget hire an external third party tobuild this this cool website and theythey stand that up and they're not asecurity firm and because thatpartnering didn't happen maybe we didn'tget visibility not that that wouldhappen with us of course because youguys are great Partners but I've seenthat happen a lot at organizations whereyou know they're trying to do the rightthing but they just you know this thismarketing firm's got a panel exposed tothe the internet that has defaultpasswords on it for goodness sakes andso if we're not constantly looking forthat but shame on us yeah my opinion andI guess the matching of vulnerabilitydata to then those external assets is iskind of a challenge it's just an ongoingyeah cleansing process that you're doingyep yep no that's right but there's beena lot of great advances you knowum in that sort of space in the lastlatter years where you know they'retaking more of an application look at itthings and and not relying on just youragent-based scanning uh that sort ofthing right because where that becomesincredibly tricky uh using some of theolder uh agent-based approaches tofinding vulnerabilities is in a modernuh architecture environment right we'reprobably running uh a virtual machineyou know so there's a physical machinerunning multiple virtual machines thosevirtual machine genes are often thanrunning Docker containers right k8s whathave youum and so you've got sub virtualizedvirtualize you know Etc and and and sothe looking at it from the same way thatthe attackers find it it just feels likea kind of a no-brainer approach and Ithink you end up gettingum we'll get right there um a wholebunch of vulnerability alerts sayingthat you have to patch all these thingsand and I you know even with our owntechnology the goal is how do youprioritize the ones that we're seeing inlive exploits how do you prioritize theones that are protecting crown jewelswell that's a good example of where Ithink we as an industry have anopportunity to continue maturing righttake product security uh a lot ofproduct security teams are basicallyjust running scanners to look for theseand then they're tossing them over thewall to the you know to the input queuefor the for the engineering teams and Ipersonally I think that's a terribleapproachum you know their job isn't to beSecurity Experts right the way ourproduct security Team Works is theproduct security folks are Engineersthemselves they ingest the toolingresults and then go figure out where theproblems are in the code and that's whatwe go share with the engineering teamsand when when you approach Security in apartnership thing like that where heyyour job is ship code our job is to helpyou ship some care code rightum that that unlocks all sorts ofbecause they don't want to ship insecurecode either right we just need to do abetter job in in often helping them withthose and whether it's vulnerabilitiesin running applications or that buildingthat kind of partnership with yourengineering teams is criticalhey thank you guys for coming awesometurnoutforeign"
}