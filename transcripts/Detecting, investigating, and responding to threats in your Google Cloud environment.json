{
    "title": "Detecting, investigating, and responding to threats in your Google Cloud environment",
    "presentation_type": "Breakout",
    "categories": [
        "Security Professionals",
        "SEC210"
    ],
    "video_id": "p1ByHBm18B4",
    "time": "Aug 31 01:30 PM - 02:15 PM CDT",
    "transcript": "foreign[Music]we're gonna have a very fun talk focusedon cloud security threat detection andsome encounters of security capabilitieswith cloud in fact when you walk downthe Expo floor you sometimes see thefact that certain security capabilitiesare built clearly by security people forsecurity people but others are built byCloud people for cloud people so thesedivisions still exist if you see atypical large company operation not thatthere's such a thing you do seeorganizations that have very clearlyderived their lineage from pre beforethe cloud era sometimes in my daily jobI kind of make slight jokes about howcertain people use cloud as if it's adata center we have this very passionateview that cloud is not just somebodyelse's computer so the point of this isthat a lot of interesting things happenwhen the traditional security thinkingencounters the novel thinking in thecloud a lot of things happen some thingsbreak some things behave differentlytoday specifically we would focus on[Music]I would focus on things that are aboutthat and this is both of us uh I'm Antonchuwakin I work for office of the Seasonor Google Cloud Google Cloud I deal witha lot of challenges dealing withhelping clients doing some researchfocused on various Cloud security topicsand many other things and I'm Johnstoner I'm a principal securitystrategist part of our security adoptionengineering team so we focus on secopsSims or some of the demanding Solutionsas well pulling these things togetherfor a security operations center Imaintain a Blog called the nudeChronicle that you can check out on thechronicle.security website so if youhaven't checked that out and you'relooking to get deeper into Chronicle I'dhighly recommend thatperfect let's get to the fun stuffas I started in my in my in ourintroduction in many cases detection andresponse that's what DNR here stands forbuilt by a traditional company frombefore Cloud encounters cloud and itproduces a fair number of interestingthings and I'll I'll guide some of youto those things now I'm assuming thisbeing Google Cloud next some of theaudience would be quote unquoteexperienced in the cloud do Cloud nativecloudborn Cloud focused and maybe theother half is kind of more Cloud curiousor a recent tourists or recent entranceto the cloud that's perfectly okay theywill be very useful things for both bothtypes because ultimately we are talkingabout how some of the security modelsFrameworks approaches and tools ofcourse tools as wellthatevolved to solve security problems incountercloudso as I said the motivation specificallyfocused on Security operation toolingthe detection response tooling these arethe questions I was asking myself when Iwas thinking about it when I guideclients that have a robust detectionresponse capability robust but bornbefore the arrival of the cloud beforethis customer or this organizationencountering cloudthese teams have built things that workwell but Cloud does break some of thosethings some things break some goalschangeum some things that they rely onactually would still work so to me thisis kind of how my my mind wasaimed at the problem I was thinkingabout how do I plan for it how do Iteach what do I teach the teams whatshould they stop doing what should theystart doing do they need to change thetools do they need to change thepractices how else Cloud changes thecraft of detection and response and thisis uh there would be some answers Ithink it's an ongoing Journey so some ofthe answers would be more of a you knowtransition state answers and manySecurity operation teams are actuallysecurity teams in general when they showup in the cloud they Encounter of coursethe concept of shared responsibility nowwhen we when somebody who never sawcloud in any way reads about sharedresponsibility kind of in a theoreticalmanner they see examples that are verycrispI am the cloud provider I build the datacenters I deal with Hardware physicalsecurity you're the client you wrotethis application you brought it to thecloud you're responsible for securitysure that's very easy if you're readinga book or a Blog if you are in real lifeit is really not because there are manyareas and detection responsespecifically is an area where a lot moreis very fuzzy a lot more isn't a lotmore is about I'm the cloud provider Ihave the tooling he's a partner hemonitors the tooling for alerts and thisother party is helping me refine thetools and cloud provider has its owntooling that sort of interacts with thisin some unpredictable ways so sharedresponsibility while a very crispConcept in theory and practiceespecially around the sock and detectionresponse becomes very fuzzy it becomesfuzzy and in many cases sharedresponsibility that is assumed to be aclean division of labor doesn't reallywork so Google of course practices theapproach called shared Faith where weplay more to help the client on theirside but even with shared fate there isstill a lot of areas where workingtogether is a must and I think some ofthe materials some of the ideas we'llshare today would be about workingtogether especially between Cloud teamsand detection response teams but itpoint is that if if somebody tells youshared responsibility is easy walk awayit's really not while the visuals can bemade this is blue this is green thereare a lot of blue green areas uh andthere are many more blue-green areas indetection response specificallynow when we say detection response thisis a question of well wait a second whatare we detecting and this is where Mandyand uh presentation media teampresentation at the same event thatcloud next highlights some of the ideasfor what threats they encounter whenthey investigate what type of threatactors what do they do what do they wantwe do want to build an overall frameworkfor thinking about it because it's avery common debate about this are thesethe same threats if I had my securityoperations center or my detectionResponse Team built in the 2000s 2010sbefore Cloud do I watch for the samethings do I look for the same type ofactivities are the threat actors thesame are there the bad guys the same andthese are good questions and many ofthem have to come up when people whenusage of the cloud grows the interestingbit here is thatwhile Cloud itself the public cloudcomputing was born you know at thispoint between one decade and two decadesago many years ago there would becompanies organizations that are verynew to Cloud they are there some of themare in this room some of uh peopleencounter Cloud for the first time in2023 and we don't want them to repeatthe mistakes that the original batch ofpeople using Cloud have done so Cloudusage grows incidents grow and in thatsense we do seeum some of the classic incidents we dosee some of the uh some novel incidentswe'll show you some data in a moment butultimately this type of thinking isnecessary before you start thinking howam I adjusting what I do for securityoperations for detection response forthe cloud environment whether it'smulti-cloud one Cloud some is a lot ofSAS a lot of other thingssothere are industry reports that has ahighlight Cloud threats and have listsof like top 11 top 12 top whatever thenumber it is actually a lot trickier andthis was kind of my obsession for muchof the previous year uh where I triedasking various people and uh conductresearch focused on what cloud threatspeople should focus on and of coursethere is so sort of data but there arealso organizations that mostly assumethat what they need to watch for in thecloud is largely the sameto what they detected what theyresponded to in the pre-cloud era andthere's a group of people who say no nono no it's completely the oppositeeverything is new so if you do talk tothese two camps especially during thesame conference you start to get thisyou know Buzz in your head like I'mconfused what does it all mean andwhat the solid lesson from this would beand it will be a highlight at the end ofcourse is that threats that affect yourCloud environment very stronglycorrelate to your Cloud usage it soundslike a bit of a no-brainer but it reallyaffects things in a dramatic manner it'sa first order effect so if I am aclassic lift and shifter who really didcopy my data center to the cloud whetherit's a good good idea whether I'm beingjudgmental here leave it aside the pointis that you did it now your threats inmany cases are in fact very similar Imean sure you can highlight some moreexotic uh types of insiders or whatnotbut ultimately a threat landscapewouldn't change if your I.T and yourusage doesn't change there would beslide tweaks but but admittedlycross-tenant threats would not be highon the list it would be you for gettingthe password or forgetting to configuresomething and then attackers exploit inthis so in that sense similarities woulddominate but if I am a startup in theBay Area that started in the cloud thatnever saw the inside of a data centerthat can't spell Mainframe uh your Cloudthreats would like to be different andyour your analysis of what to watch forwould also be differentnow what about some hard data so Googleof course runs a cloud as you've heardthis is Google Cloud next conference andso we observe what gets broken into whatgets compromised what people attack wehave this amazing series of reportscalled red Horizons this is from numberseven and if you look at this particularpie chart you see this big big red sliceand here we say we can know password butit's really more like broad challengeswith authentication I am if I broaden itfrom week or no password to otherauthentication problems or possibly evenother permissions problems it will growso this means in many cases what getsyou in the cloud is not some kind of anexotic zero day in the virtualizationlayer what gets you is no password andI don't want to decide to analyze peoplewho do this but in some cases they copywhat they thoughtwas true for a data center into thecloud and the result is that they don'tactually realize that the world aroundthem changed and the fact that they havethis database server behind Fivefirewalls deep inside the company thisis now a SQL instance somewhere in thecloud sothis visual uh based on what we observein terms of cloud compromise indicatesthat what gets you very often in termsof popularity is the old stuff not thenew stuff it's the not adjusting to thenew realities of the cloud rather thanexotic Cloud threats and this is a goodlesson and that that's a very usefullesson if you run a sock or detectionresponse team because you'd be watchingfor things that you kind of had to watchfor in the past but maybe you did lessduring threat Horizons uh and actuallydo read uh maybe a few recent onesbecause you will have a much cleanerview of what actually going on in in thein the mass of cloud in Cloudenvironmentswhen we do talk about similarities anddifferences what I want to go to next iskind of how to put this knowledge tosomething practically usefulnowwhen I try to apply my traditionaldetection response think in the cloud Ido encounter challenges I do encounterOne Challenge is of course the fact thatmy people my team probably isn't asCloud aware and I used to joke and usedto sound like a broken record a littlebit how that they do need to pick up oncloud Technologies and specifically oniam and this is I may not like I am Imay not think I am it's fun but I am ishugely Central I I've seen a I ampresentation that my colleagues uh givenyesterday was pretty pretty crowded so Ithink that many of you are getting themessage that I am would ultimately getyou if you don't get I am in the cloudbut the risk killing or rather upgradingthe skills is kind of one of the centralelements so it kind of sounds a littlevague but it's also very practicalbecause I've met people who are lookingfor IP addresses for server names andfor things that may not make sense inthe serverless uh environments andwhatnot so this these things arehard to lay off to the side for somepeoplea lot of the incidents a lot of attacksa lot of detections as you learn furtherin the presentation would would have ajoint nature now um some of you knowthat I used to work for Gartner andGartner had this line that a largepercentage let's say 99 of cloudincidents are customers fault it's theline that gets copied from researchpiece to research piece and it's kind oftrue but it's also not the very pleasanttruth in that sense The Joint nature ofattacks a joint nature of response jointnature of detection is quite Central andthis is to what we are trying to changewith shared fate for example finallyyou do look at the data and John wouldcover some of the things how we do itand what type of data for detection andon a very high level if you go look at a30 000 foot view sure you have logs oryou have other stuff but there arechanges that are quite Central to doingdetection response and your sock yourdetection Response Team your securityteam in general we're gonna have to pickon some of that and we'll show you hownowhow are these things changingwhat happens if you don't change andthis is uh from my fairly old blog thatI've written two years ago uh Soft Meetclouds you won't believe what happenednext and this is uh sort of a laundrylist or a shotgunsort of a scatter shot of issues thatpeople encountered if they try to notchange and basically assume cloud is aData Center and we'll just get the logsfrom systems shove them into our Sim onpremise probably and then just hope forthe best a lot of things just don't workor they work so badly that you almoststart debating whether they're worthdoing and I've seen people notunderstand a lot of Concepts like whatdo you mean the resource name I mean Inever had resource names in my 1990sdata center in because as we say here inkind of Legacy Land We a lot of thethings just didn't have equivalence eventhe the similarities and differencesinside identity management we're allquite quite befuddling so and ultimatelysome of the security vendors haven'tevolved and some of the security vendorsas a result got left behind because theynever really grew to work well withCloud customers so to me these are youknow fun to discuss But ultimately whatare we doing practically that can helpus do a robust detection response in thecloud for a team that wasn't born in thecloudall right so let's talk about a coupleof tools and practices that we can bethinking about In This Cloud spaceitselffirst question we probably want to askis do our detection and response toolswork in that space and the answer ofcourse is it depends rightum if you're in that infrastructureParadigm and this is the tricky partbecause you kind of float back acrossall three of these depending as to whichtooling you're using across the boardright if I'm just taking my machines inmy on-premise environment or evenvirtual machines in my on-premiseenvironment and moving those into acloudthose EDR systems that I've got outthere might work just fine right you getthe good enough the checkbox rightum and you went overboard with acronymsand for detection response Networkdetection response Cloud access securitybroker and of course same as every saverI'm not expanding this one we'll get tothat one yeahum but the idea here is is that I couldgo ahead and do something like that withnetwork detection or response right Imight have to do some uh packetmirroring I might have to do a littlebit of configuration right that might bea little bit of a a reach because it'snot quite like a tap that I might beused to but I can also set up a you knowa zika core light or what have you andbe able to sniff those packets in thatis environment and be able to do thatkind of traditional ndrum from a login Sim perspectiveobviously whatever logs and Telemetrycoming off of those systems and thecloud audit we can go ahead and grabthose kinds of things casby probably notas much of a fit in that spacebut then when we move into the platformright platform is a service things likelet's say a big query or any kind ofdatabase as a service orum or storage Right Storage bucketsright then all of a sudden those edrskind of fly out the window right youdon't have an endpoint per se to be ableto put a shim on and to be able to lookat detections maybe in the network spacethere's a little bit more you can do butit's a little bit more constrained casbythere might be a little bit more withapplication calls that you can work withmaybe yes maybe no it was going toprobably depend but again the logs inthe Sim Space they're still availableright they just might be a little bitdifferent than what you're used tothen we get to software as a serviceright so software is a service whetherthat's something like an octo or a salesforce right or something that anothercommercial provider right at that pointokay there's no EDR right there's no ndrit's whatever they're going to give youright and that's kind of when you fallback onto casby to be able to go aheadand say okay what are these callslooking like back and forth but ofcourse with the sales force with an OCTAwith any of these other things there islog Telemetry coming off of those that Ican go ahead and pull into my sim and dosomething withall rightgot the wrong direction I knew it wasgoing to do that all right so what'ssome of the good news that we've got outthere wellbeing able to do some of these things inthe cloud makes this a good bit easierto do from a SIM perspective in ascalable Manner and when you say why isthat I'm going to go ahead and go backto this gentleman on the left'scommentary that he wrote in 2012 sowe're going back through the sands oftime and talking about some of the Simchallenges and a couple things he calledout at that point in time with thetrifecta of complexity deploymentAdministration and operation and we talkabout operation we're talking about tooloperation and I kind of think back to mytime between 2012 and today when I I hada Sim that had a Java virtual machinethat if I put more than 10 000 eventsper second to it it might fall overright that's a problem even five yearsago in the Sim Space I had to beconcerned about what kind of searchsystems that I had and indexing systemsthat I had to be able to balance thoseloads so that it wasn't compromising myindexers and having them stop working orcompromising my users by not havingplaces where they could actually dotheir searchesright by moving us into the cloud thatsolves those kinds of elasticityproblems it allows us to go ahead andingest large volumes of data from lotsof different spacesbeing able to have those apis providedoutward right makes it a little biteasier to go ahead and do things withsoar whether it's Automation andplaybooks because there are much richerapis available to you to hook onto soyou're not getting into having to scrapethat data to be able to get at itsimilarly from a defensive perspectivewhen you start looking at the workloadsthemselves there's a concept called vmtdI'm not sure how many folks are familiarwith that virtual machine threatdetection within security Command Centerwe're actually looking at that frombasically the hypervisor layer rightbelow the instance that you've got spunup to be able to detect things likecrypto mining okay and the benefit ofthat is is that you know yes we said youcould go ahead and put a DDR on yoursystem benefits it's magical really yeahwe take care of it for you some threadsmagically disappear and they can't runconvert and so to me this is kind of theexample where cloud is a really strongAdvantage the benefits certain thingscertain bad things can't workand then the last part of this isobviously from a security perspective wecan go ahead and do this fasteraltogetherum using things like what we call thedigital immune systemand so the last point I'm kind ofalluding to a Blog that uh my boss thecease of Google cloud has written soPhil cannibals wrote this blog calledeight megatrans and the point of thisblog and it's very much acquired writtenfor pretty much everybody is that cloudis as a system not just more secure thanmost all data centers at this point butit's actually getting better over timeand this to me is a big big piece ofgood news that the traditional 1990s or2000s detection response teams are notused to they're not used toorganizations uh infrastructure securityimproving around them by Magic and to methis is something that hugely mattersand it's something that the cloudnatives take for granted but people whocame through the ranks on Data Centerand traditional security are havingtrouble accepting that actually thingsget better around you if you do nothingnot all things not in every way butcloud is becoming more secure over timeso a couple other things that we'redoing in this regard is we're buildingCommunity detection rules so out onGitHub you can go out and find ourcommunity rules that we've got out therewe are building those leveraging some ofthose Concepts within that digitalimmune system uh around tour exit nodesright that Google is gathering up andmaking available safe browsing dataright those kinds of things so that froma I'm collecting my logs I have thesethread Intel sources that are comingfrom gcp let's go ahead and put thosethings together and alert on thosedetections uh similarly we've partneredwith OCTA that we did some work that wepulled together some of the capabilitiesthere so again a good example of a SASprovider who has their logs you knowsome of these are kind of traditionalauthentication use cases but some ofthem also tap into Concepts that OCTAhas like their fast pass capabilitieswhere we're able to utilize some ofthose pieces and be able to go ahead andbuild detections off of those as wellanother another project that's going onout there is the cloud detection usecase the cloud detection use case uh youcan find again on GitHub under securityanalytics project and there's a numberof different ones you know we talkedabout I am a little bit earlier and thepain points that can come with I am andneed to know that there's actuallydetections around I am around Cloudprovisioning activities around networkactivity data usage and the like sincethose are available to you as well to goahead and deploy within your environmentthe third group of detections I want totalk about are what called curateddetections now curated detectionsactually will reside inside of Chroniclethis is something that our Google Cloudthreat intelligence team gcti uh isbuilding the set of detection Engineersthat build these different rule packsfor uh Chronicle and we'll talk aboutthis a little bit more in a second doingsome practical rubber hitting the roadhereso let's talk about secops for gcp we'vekind of talked a lot a lot of differentconcepts a lot of different challengeslet's kind of put this together as thepieceswe want to be able to ingest allsecurity relevant data rightfrom the cloud from on-prem maybe fromother cloudsSAS providers what have you pull thosepieces together and be able to search onthose to be able to hunt on those to beable to run detections on those goingback as far back as 12 months right youknow by default and so that's what webuilt this around is being able to havethat scalable capability to ingest allof those logs but also have aperformance search to go back and lookfor the Badness inside of them and notjust performance almost instant in manycases this is kind of people who used tosit in traditional security operationscenters are probably thinking that asearch that takes five minutes is quickbut noyou lived in those environments quite abit right yeah you would think a searchthat takes five minutes is quick rightyougo get a cup of coffee and come on backokay you got something back but in inthis case we are talking about like theGoogle speed search right hey this isGoogle so Google's research is kind ofreasonable right for many cases this isthe change and this change is quitedramatic for many many teamsthe next thing that we want to be ableto do here is be able to identify Cloudthreats so we talked a little bit aboutsecurity Command Center security CommandCenter is focused on gcp and theenvironment and it has a combination ofboth threat detection inside of it soremember we talked about the virtualmachine threat detections right lookingat that down low lower in the hypervisoraround the different images but alsolooking for things likemisconfigurations if you go back to thatearlier slide I'm not going to flip backto it so if you have a photo of it youcan skip back to it or just remember inyour brain there was what 54something like that it was like morethan half of those things in that reporttalked about I am and passwords beingpart of the problem around those Cloudthreats I think another 19 wasmisconfigurations these are the kinds ofthings that the security command centerpieces can help Bubble Up and pushforward and then from there we canobviously ingest them into Chronicle andand triage them and do other things withit from there which brings us to thedetectiontalked about community detectionscommunity rules we've talked aboutcurated detections being able to writeYara L for you're not familiar with YaraL Yara L is an offshoot of Yara which iswhat virustotal uses to build theirsignatures uh that we've adapted forchronicle but to be able to go ahead anddrive detections using these differentrules out there to be able to look andidentify for these crowd Cloud threatsnot crowd threatsuh once you have those threats detectedyou want to alert on them those alertsneed to be able to visualized right sorather than going ahead and just sayingwell here's uh detection and here's abunch of rule a bunch of events have anice day we've started buildingvisualizations to make it easier for ananalyst to look at this and say Here'san alert here are the entities that areassociated with them when we talk aboutentities we're talking about users we'retalking about assets we're talking aboutresources you'll see that more here in asecond but when you think aboutresources think like uh bigquery tablesthink about data buckets right thingsthat aren't necessarily the classicserver right and and user out thereright it's it's it's that in betweenkind of thingand then from thereonce we have those alerts we don'tnecessarily want to have to playwhack-a-mole right with each individualalert we want to go ahead and bundlethose up be able to look at this morefrom a case or a threat View and be ableto look at them from that perspective beable to drill down into it understandwhat those different pieces are and thenfinally automate that response so thatwe don't have to sit there and have theanalysts keep doing the same thing overand over and over again right we want toreduce that toil we want to have themmove forward into the things that wereally need them to learn like learningthe cloud environment as a whole notjust that he didn't say AI a single tabthat's a huge achievement and I think atthis conference specifically it's likeit deserves oh there will be AI in themomentall right so I'm going to go ahead andgive you kind of a for instance herewe're going to go through this we arenot doing this as a live demo because Iam not going to tempt thoseFatesum but what we'll look at here is iswe're going to have an attacker they'regoing to gain some access to a publiclyexposed service account key that serviceaccount key happens to have bigquery andCloud SQL privileges associated with itor permissionsfor the sake of time and not goingthrough everything over and over againwe're going to kind of focus on thebigquery portion of this but I'm goingto kind of walk you through where thislooks like and how these differentpieces that I just talked about all cometogetherall rightall right sothe first thing we want to talk about isgetting our data in so getting data intoChronicle now is very verystraightforward from gcp The Chronicleactually has its own spot in the cloudconsole you have an integration that'sset up uh once that is set up within itthere is the concept of what's calledindirect ingestion so no forwarders noshims or anything that have to be putinto place direct ingestion allows us togo ahead and a toggle switch turn oncloud logging for gcp asset metadata andsecurity Command Center findings and youcan see literally it's clicking fromenabled to disable for those differentthree different data sets and saving itat that point those different data setsstart coming in and populating withinChronicle itselfokay once I have my data coming in now Iwant to start looking at detections andso we've got a number of differentcurated detections out there there's anumber of rule packs that we've builtaround this and we continue to go aheadand enhance and modify thesehopefully it shows up okay and so as anexample I could go into each one ofthese different rule packs and go aheadand click on specific rules or packagesof rules and then go ahead and turn onwhat kind ofum alerting item detection I want tohave so this is an exfiltration alertthere is two different settings preciseand Broad precise would be moresomething that you would turn on in asecops environment broad might be moreof a hunting kind of detection and thenthe alerting piece is separate from thedetection so you might want to turn yourdetections on run it for a little whilesee what you get before you startqueuing it up for your analysts we alsogo ahead and show active rules and thosekinds of thingsonce that's created then we have thepieces coming together we have an alertqueue we can go ahead and filter thatdown to specific alerts that we careabout we can go ahead and uh you know inthis case we're going to go ahead andlook at this over the past 24 hours wecan go ahead and filter this furtherdown to just specific rules so we'regoing to look in this case around anexfiltration rule that we care aboutwhich is basically a set of relatedoccurrences we notice we have a specificI am a specific user that's referencedin this Rule and then we get to thispoint here I'm going to pause it herebecauseknew it was going to happen there we gookayquick saveall right so at this point this that yousee and highlight is the alert itselfright that's a singular alert okay nextto that those other little triangles areother alerts so this is what we call thealert graphum rather than watching me go ahead andsay Here's an alert and let's go aheadand explore and see a bunch of otherthings pop out that looks really kind ofcool but it really gets a little bitlike okay here's five other alertshere's 20 other alerts right so I'mgoing to staged it here for you so youcan kind of see what this would looklike as you're walking through itbut what we have here is we have aspecific user over in the lower lefthand side of the screen there who is theimpacted user okay we've got an IPaddress associated with this we have acouple of tables on the right hand sideof the screen that are bigquery tablesone's called keys customers and theother is called customers so these arebigquery tables we're running DLP onthese so this is going ahead and takingDLP data bigquery data and running thisthrough uh SCC to go ahead and anddetect these on the left hand side ofthe screen we've got these little cardsthat talk about the alerts and then theentities that are associated with itso as I'm looking at this and I'm tryingto understand what I've got here I'vegot these cards that describe this atthe high level I've got the entitiesthat I can visualize but I still have myevents down at the bottom of the screenso I still want to get down to the rawevents I can go ahead and drill into theraw events and be able to see thatinformation here are there moreresources or more entities that I wantto go ahead and associate with this Ihave them down at the bottom of the pageand I can go ahead and add them into myview so I can go ahead and maybe putthose in there to go ahead and Tracefrom one thing to the nextfinally we also have alert context sothe context is some of the pieces thatour gcti team are building from acurated detections to provide thatadditional context from the raw logsthat you can go ahead and see and so inthis set of rules we could see thatwe've got the affected tables we've gotAssociated alerts we've got risk scoresand we've got some Associated API callsall right there in the view that I don'thave to go digging for any of thatinformationnow if I pivot to another one rightbecause maybe I've got this thisspecific user and I'm concerned about itI can pivot to a bigquery exfiltrationwith DLP context and in this case againI got alert context that talks about thecustomers table being impacted it wascopied off to an attacker controlledtable called patience there is DLP infotypes around credit card numbers date ofbirth email addresses Social Securitynumbers all in one table it's a goodplace to put all your data in one tableright anyhow but I can go ahead and seethat kind of information because againI'm pulling those DLP pieces in withthose tables themselvesI'm going to go ahead and pivot to athird right because the same same IPaddress has these three alertsassociated with it in this case the keyscustomers tablewe're seeing this alert firing offbecause we saw this table exported outto a storage bucket right a CSV and astorage bucket and again with the DLPwe're saying hey there's keys in this inthis storage bucket that were exportedor exfiltrated and email addresses aswell so we're getting that biggerpicture herefinally as we look at the other alertthat's associated with this specificuser we see this fourth event which iscalled persistence anomalous Grant andso what does that mean basically whathappened here was that this specificuser went ahead and provided a key tothis user called analytics workload gavethem the editor role and that role spunup a workload called one two one twothree four five in the central 1A regionright so fraud waste and abuse kinds ofuse case at that point right somebodyspitting something up maybe going to docrypto Miner maybe gonna do some otherstuff with itbut I can take all of those things inthat alert and feed that over into acase view where I have you know in thiscase there's actually even more alertsthat are associated with this is about15 different alerts but they're allbundled up into a case they're allgrouped together based on time and thatuser and say hey these are all part ofthis overall larger threat and so I canview this from a case perspective inthis view but I can also go ahead anddrill into each one of those alerts andI can run playbooks on each of thosealerts to go ahead and do somethingso let's look at the anomalous Grant onethat we've got in that anomal is Grantalert which we'll see here in a secondall right we can go ahead and see thatwe've got a Playbook that ran against itwe can see that we've got an alertassociated with that which I could drillback into the Sim and look at all of thedetections that happened with that rightso I go back to that raw data but as Iscroll down here I can also see what aresome of the other entities that are partof thisI can see that we've got in this case435 if I just scroll down a little bitfurtherscroll there we go 435 Associated asimilar alerts so maybe if this has beenhappening an awful lot I maybe mightwant to do something else about thisrather than have it happen all the timeI Can See enrichments For miter attackagain from the playbooks running in thebackground and even if I had somethinglike a virus total shim I could take myIP addresses look I don't have anythingin virus total there but maybe if I hadfile hashes for a different use case Iwould get thatnow in the bottom right hand side of thescreen here we've got a remediationsummary so this is actually somethingwhere we're in that Playbook and itturns out that we've already remediatedthis specific issue right we went aheadand terminated that workload workloadone two three four five and we disabledthat account that we had that editorrole access to and how do I know thataside from it telling me that I couldalso click on the Playbook itself andsee the Playbook history so the Playbookhere is kind of a nice kind of run downhere you hit a fork in the road and thenyou do this or that right when I clickon the if then or that basically what Icould see is is that I got to this pointin myin my playbook and because I had theinformation around the email addressthat I needed to go ahead and terminateI could go ahead and take action thereif I didn't have that I might have togenerate an email to send it to somebodyand say hey can you go find this thingand take care of it but because I havethose different pieces I can go aheadand streamline that effort I probablywant to work on the root cause of thatbut I don't have to sit there and spendmy time finding that system turning itoff finding that those keys terminatingthat user and those sorts of things Ican move on with my dayall rightso we're about at the end of our timeum where we want to go ahead and kind ofleave you with is a couple of takeawaysand then after that I think we're goingto open it up to questions and I thinkthere's a mic here in the front if thereare questionsbut there's a couple of things that wewant to go ahead and think about as wego through uh and hopefully coming outof this so do you want to go ahead andstartsure I would say that the I mean thefirst line the first takeaway here isnot just me being trying to be funny butI think that when people quote aboutCloud mistake configuration mistakesidentity mistakes and then they saycloud is challenging we do say thatcloud is challenging if you don'tunderstand it and it becomes a veryobvious statement ultimately many of thepre-cloud security teams probably needto invest a lot more resources in thelearning cloud sure we can make thingseasy we can provide guidance you knowConsulting advisory you know that's whatI do some of my time but it would behard until people Minds change the factthat cloud is different enough it's notjust somebody else's computer take thetime to run the cloud if you're focusingon one area and if you're sort of arelatively new Cloud entrant it would beIAM because again threaten threatindicators show that the likely I ammistake is what gets you nowagonizing over threats is maybe a funthing for me to do but uh for manyclients threats would closely correlateto the type of usage if you are arrivingwith the on-premise ideas Technologiespractices likely your threats would bevery similar to what you had if you arestarting in the cloud you would have afairly significant difference in howthreats look so to me this is kind ofthe assess your own cloud threats is theanswer and there are many threatassessment methodologies way to modelwhat's going on your systems and thenyou go to use cases as John pointed outbut the use cases libraries would haveto be tweaked and kind of colored so tosay by what type of threats you face tome it's not enough to say hey Anton andJohn give me the list of threaddetection rules and I'll run themsure we can and we do but in many casesthe value comes from you understandingthe threats and then tune in this towhat you facefinally we did say that a lot of cloudNatives and Cloud focused companies takeautomation for granted but a lot ofsecurity teams that landed from onpremise do not and automation is a hardjourney for them and even understandingthat I.T and business around them haveautomated a lot of things but they havenot is is the daily reality so toolslike source security orchestrationautomation response again anotheracronym from my former colleagues is apathway to automation for many stocksand this to me is improved quite a bitwhen it's soar is cloud native cloudbornconnects to Cloud so to me this is veryclear that automation for security teamwould not just be learning how itautomates that's a big bucket of it butthe other bucket is of course usingeither the same tools or sore tools todo thingsyeah and so then when you talk aboutCloud hygiene right a cloud hygiene andposture tremendously helps yourdetection and response if I know whatI'm defending I have a much betterchance of being able to defend it andbuild detections towards those thingsbeing able to ingest the metadataassociated with those different Cloudentities helps me be able to kind of geta handle on what are the things that Ihave out there in my projects now doesthat cover all of the Rogue projectsthat are out there maybe not but atleast it gets you started with the stuffthat you're that's that's associatedwith your environments right and thatobviously has has tie in from anon-premise world right we don't knowwhat we're defending and be able towrite detections to defend itlean in on that cloud service providerdata feeds that are out there Imentioned things like safe browsingright which we have access to go aheadand ingest those file hashes tour exitnodes is another data set that we goahead and lean in on uh even things likevirustotal if you're using virustotaldata you can ingest that into Chronicleand and a number of other data sets butleverage those data sets to be able togo ahead and say you know what there's acommunity of folks out there that areidentifying these things that areknowing that these things are bad rightyou think of the neighborhood watchkinds of scenarios that's kind of wherethis piggyback so it's a combination ofneighborhood watch plus gcp kind ofsaying this is problematic let's lean inon those kinds of things identify themand detect and remediate from thereand if you don't know where to startright there's a lot of things that areout there that you've done in theon-premise environments as Anton hadreferenced before start with the thingsthat you know start the things you'recomfortable with if you're notcomfortable with going ahead andhandling storage buckets and bigquerytoday that's okay right there's stillthe virtual machines there's the isportions of this maybe there's the SASportions of it that you're more familiarwith because of other history that youhave start with the pieces you know workon those detections in those use casesand then build from thereforeignwe sort of mixed some of the high levelmid-level detailed stuff so hopefully itwas useful for enough people any anyreactions any comments questionswell sounds like it worked out thank youforeign"
}