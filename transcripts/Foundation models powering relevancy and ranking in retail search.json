{
    "title": "Foundation models powering relevancy and ranking in retail search",
    "presentation_type": "Breakout",
    "categories": [
        "AI and ML",
        "AIML205"
    ],
    "video_id": "rSMSpUPa7nA",
    "time": "Aug 30 01:45 PM - 02:30 PM CDT",
    "transcript": "foreign[Music]so in today's session I'll basicallytake you a little bit through some ofthe background context aroundgen Ai and our product portfolio thathelps gen AI Developerstickets peek under the hood and maybedive into some of the AI models thatpower retail searchand then we'll try and get into some ofthe cool exciting work that we arecurrently doing around llms and how theycan actually improve relevance in retailsearch and a bookend it with like someof the customer success storiesoh maybe I should introduce myself I'mChandra Prasad I'm an engineeringdirector in Cloud Ai and IndustrySolutions at Google and in gcp and incase you're wondering if I lookdifferent there's not a generated AIpicture but it's just me when I joinGoogle so it's a little bit oldI thinkso let's take a look at some of thebackground for today's talk and I'll tryand give you a little bit of a broadcontext before we dive into things indetailso if you put together like a worldcloud of all of the technology trendsthat have happened in 2023 I canguarantee that generative Ai and largelanguage models would dominate thatentire you know World cloudif you think about the opportunity thatllms provide it's tremendous for us tobe able to innovate and to drivebusiness growthbut processing the large amounts ofcomplex data and being able to extractthat information is pretty resourceintensiveso it's not accessible to allEnterprises however large languagemodels have processedpretty much all of the world's you knowpublicly available information whetherit's text whether it's images or audioand made it available to Enterprises touse in a convenient and easy to useinterfaceso if you look at howllm's work they understand humans moreintuitively so it gives us theopportunity to be able to use thisunderstanding of humans to createseamless and more natural interfaces andonline experiences for our Shoppers thatis much more in tune with what theyexpect in today's worldif you but if but if you go back most ofwhat people think about in terms ofgenerative ai ai or llms is really aboutcontent generation right so that it'sreally helped Enterprises make theiremployees more productivebut that's not the only way in which wecan use these large language modelsdepending on the expertise that youapply to the problem Enterprises cantake them and customize them andintegrate into their existing Solutionsand in their technical infrastructureso in order to be able to do thatgcp provides aa set of tools that's called vertex AIportfolio and what we've tried to do isto bring together all of the tools thata gen ai-centric organization would needunder one brandso if you look atmodel Garden model Garden pulls togetherall the best of the first party thirdparty and open source models into oneeasy place that's accessible forEnterprises to be able to prompt tuneand distill and there's over 100 modelsmodels that are accessible right nowthe AI platform is targeted more towardsdata scientists and it's used to managethe entire life cycle of your AI modelall the way from experimentation totraining and deployment and productionbut more importantly it providesextensions and several data connectorsto important to data sources that allowsus to bring in the data andeven more importantly it lets you groundthe answers that the llm gives in theCorpus of your data so it doesn't starthallucinating and creating stuff that itshouldn't be doing so it's reallygrounded in your Corpusthe search and conversation layerprovidesdevelopers a way to build Innovative genAI apps that really you know the promiseof seamless user experiencesand developers can either Leverage Thejumpstart kits that we have or directlyaccess the sdks apis and libraries todevelop their applicationsand putting it all together the AISolutions is a set of very powerful AIagents that allow business users to gettheir job done and so some of theexamples there are like contact centerAIum anti-money laundering AI Discovery Aiand document AI rightin addition to what Google provides is awhole broad ecosystem of Partners whobuild out Solutions on top of vertex Aiand bring it to our customers or theircustomers and many of our theseSolutions are being used by customerslike replit or typeface and gitlablast but not least all of this is builton top of Google compute and Cloudinfrastructure that is highly optimizedfor machine learning workloads andprovide deep connections into the Googledata cloudretail you know has been in a constantstate of fluxthings are being disrupted we have totransform ourselves and this journey hasbeen going on with entitiesbreaking you know the Can I just askthat door to be closed if you don'tthank youso so many entities who are basicallychanging the the steps in the valuechain so thatum you know they use existing models butare changing the model to be able toprovide better customer experiencesandthe pace of Innovations you knowevolving rapidly and it also makes itdifficult for us to keep upcustomers of today expect things likeyou know seamless digital experiencesonline they want to be able to havepersonalized experiences that goesacross channels they want to be able tolook at inventory levels andavailability of product they want topick the channels for you knowfulfillment but these are all likeexpected and this is continuing toevolveandin order to be able to serve thesecustomers we need to innovate quickly beable to pick the best of breed solutionsthat exist and focus the Enterprise onthe hard problems that nobody else issolvingand while technology has traditionallybeen part of multi-year plans forEnterprise for retailerswe increasingly see it as something thatis a in-ear value driver with concreteshort-term benefits while setting up theEnterprise for long-term successso what does this all mean really if youlook at theshopping Journey the steps in theshopping Journey have pretty muchremained the same over the years exceptthe way that the Shoppers areinteracting with technology in each ofthese steps has evolved tremendouslyover the yearswe can continue to drive this evolutionby using the latest techniques we havetoday with Gen Ai and AIespecially since Shoppers are much morewillingall the much more conversion withtechnology they've been used to usingthis and they're much more willing totry new things as long as it providesthem valuesothe whole intent here is to be able todo this innovation in a way that'spragmatic can we think about you knowtime return on investment time togetting return on investment quickly canwe make sure that we can exist thesethings integrate these things intoexisting technology stacks and yet makesure that these technology Stacks areopen for extension in the futureso providing these kinds of experiencesand being able to get customers to shopis a pretty big challenge that retailersare trying to navigate through it'soften very hard to understand userintent and to be able to personalize andsurface the right products so that theyactually buy so if you don't do thatwell we leave a lot of money on thetable and these are some of the numbersthat show how not having the rightpersonalized search experience thatgives customers what they're reallylooking for can can doto help retailers along this journeyGoogle cloud has this thing calledDiscovery AI or Discovery productDiscovery Solutions it's basically threeproducts that are converged together inone offering there's Vision product AIrecommendations Ai and Retail search soVision product AI you can just think ofit as like Google lens for those of youwho use Google Lenson your own mobile app experience so ithelps Shoppers as well as in-storeAssociates be able to quickly look up animage of a product and see relatedproducts from your product catalog or inthe store using AIrecommendations AI isgeared towards delivering personalizedexperiences for your Shoppers across allchannels and Retail search provides theGoogle quality search results thatreally looks at what the Shoppers intentis and making sure that theproducts that are being returned as partof those search results are relevantso whether you know you're using searchor browsing and browsing is basicallylooking at product categories or usingrecommendations the thing that thesethis these three products do ispersonalize the Shopper's journeythrough the entire experienceso Discovery AI really tries to providerelevant search results and personalizedexperiences that allow customers to beable to do you know queries that maybethe retailer hasn't seen in the past butwe understand the intent we have areally good way of having queryunderstanding that uses a lot of signalsfrom Google shopping and customerbehavior on Google shopping that sayshey what is are these the kinds ofrelevant products based on the queriesthat they've done and brings that to theretailer so that you don't have emptysearch results when somebody does aquery orit's not relatable to the actualShoppers that understands their personalpreferences or their tastes and habitsso with that background let's take aquick peek into under the hood let'sopen up HUD and see I walk through someof the models that actually are used inretail search and browsesojust stepping back a bitsearch has two big problems relevanceand ranking and each of them isimportant for different kinds ofsearchesso for so what is relevance reallyrelevance is really trying to understandthe Shopper's intent and saying what isit that you're really looking for andI'm the service results actually reflectwhat you are really looking forand it's extremely important for what wecall tail queries tail queries arebespoke like uncommon queries in in thiscase it's like a high-waisted boyfriendjeans when someone's coming up at such ayou know bespoke queried they're verysure about what they want and if wedon't give them relevant results it'sgoing to end in an abandoned searchsession rightranking on the other hand is a differentkind of problemI can get all the relevant products thatsatisfies this you know the Shopperssearch intent but what order do I showthem in so that I maximizes the chancesof them clicking on something andpurchasing it so if somebody searchesfor something very generic like saywomen's pantsyou know there's a lot of products thatwould fit that search result exceptshowing it them showing them in randomorder will not guarantee that you willreally get someone to click on it andbuy themso let's take a sample query right andlet's say short sleeve long dress all ofus understand what that isbut if you think about Legacy systemsthat use text-based search it's a veryhard problem because they look atindividual words short sleeved long anddressthey don't understand the relationshipbetween these thingsand thereforejust looking at it from a word count ora you know matching words the kinds ofproducts that you show will not reallyreflect what the the search intent wasand what this does is it requires theretailer to be able to put a whole tonof manual rules that says hey by the waythis is what you need to filter it bythis so this is a whack-a-mole right soas you find more and more queries thatyou've never seen before you're addingmore and more rules andthere's another downside to this problemthe best thing that you can achieve outof the system is to be able to sort orrank these results based on how relevantthey are but really that's not what youwant to do you want to be sorting thembased upon what what the Shoppers tryingto click and purchaseso what retail search does is it has alot of learning fromGoogle shopping and our AI expertise andwe bring this to retail searchto identify relevance without reallylooking at words right so this is whereI think large language models would comein so let's take a look at the firstkind of model that we have it's a alanguage model and the purpose of thelanguage model is to take a raw querywhich is stream form text and convert itinto a structured querylook at some of the hard keywords haveto be interpreted for example if you saylarge large could mean in Context ofHardware or Nails it could mean nailsthat are four inches or longer but inthe context of mattressesit's king or queenso you have to really discern what theintent was in order to be able tointerpret these hard words and andconvert themso once you you get this then you alsostart looking at doing language basedfiltering so for example if someone'slooking for a blue blouse you go oh Ithink I know what that isthe product is blouse and I'm going tofilter on the color blue except it's notthat simpleI can search for red blue jeansright there's no such thing as red blueglasses but there's red blue jeans soyou have to have an understanding of howhumans use the language for this to beable to convert it into a structuredquery that can then be passed on to therelevance AIso the relevance here is a you know abunch of different relevance models thatare then combined together by another AIand in this case you know we've gotyears ofhumans running queries in Googleshopping and clicking on the results weknow what they clicked on and what theydid click onso by doing that and observing thatbehavior we're able to discern theintent that the customer or the Shopperhad is like okay when they say shortsleep long dress these are the kinds ofthings that really matter right so thisis extremely important and this isthe data or the the knowledge fromGoogle shopping is used to train theRetailer's model and not the other wayaround by the way so we don't use any ofthe data that comes from the retailersmodeled to train any of our AIS but it'sthe Google shopping data is used totrain the retailers modeland oh and one other thing so it doesn'treally matter which retail is sellingthe short sleeved wrong dress a shortsleeve long dress is independent of theretailer so it's very general humanknowledgeso after it the the relevance AI goes inand gets the relevant resultsit takes the top 400 and sends it off tothe rankerbut before we go there one of the areasthat we're really excited about thisyear is the work that we're doing onllms and how we can improve ourrelevance Aiand so I'll speak a little bit aboutthis in the in a later sectionso the relevance AI then goes and saysokay let me takeumthe 400 top results ship it off to theranker so it can show them in the rightorderso the the ranker gets you know yourrelevant results the processed query andwe also get used events from theretailerso what do we do with these user eventsthe first thing that we do is to send itto the personalization AIpersonalization AI basically onlyoperates with the retailer specific userevents of the user behavior on theirparticular site rightso we kind of look atwhat what do they search for what arethey what have they browsed what kindsof things do they click on whatever theyadded to their shopping cart and what dothey really purchase rightand once we do that we can startunderstand oh by the way we don't lookat demographic data we don't look attheir behavior on other retailer sitesnor do we look at how they behave onGoogle properties like YouTube or Gmailbut it's really their behavior on aparticular retailer siteso once we do that we can startextracting some patterns purchasingpatterns or user tastes I think I knowwhat kind of products you like or youusually purchase what brands you preferwhat are your preferences in terms ofsize and colorand then we put it together and then wecan also do some correlations like someof our tastes in shoes might correlateto our tastes and accessoriesbut Artisan Lumber aren't going totranslate to our tastes and faucetsright so it knows what things arecorrelated what things are not andstarts learning a little bit more and italso looks at time-based patterns solet's say I've buy dog food for my dogevery monthif I had purchased dog food a little bitmore than a month ago when I went andsearched for dog supplies I hope I seedog food in the top of that list becauseit's time for me to buy the dog food butif I just purchase it last night itdoesn't make any sense to have it on thetop of my list so it learns these thesepatterns over time and then uses thatinformation and provides them to therankerforeignso what is the ranking AI really tryingto do it's really trying to figure outwhat is your likelihood of making apurchase so that I can rank the items inthe search results in the order of mostlikely purchase but more importantly notjust likely purchase but highestexpected Revenue which is reallyum you know like the likelihood ofpurchase or the probability ofpurchasing this item times the productprice right so how does that the rankerdo that isthings that people bought for this queryin the past I have an idea of what whatthat is and then it starts analyzingTrends over time and then it folds inthings like your personal preferencesand tailors those research results toyour particular shopperand again as we said and then it takes alook at your expected revenue and ranksthem based on that orderso in going back to our you know queryshort sleeve long dress you can see it'sprocess very differently from Legacy applike you know search applications versuswhat an AI first approach would do soyou know in the Legacy application it'sabout word counting it's trying to makesure that we put a lot of manual rulesto start constraining the problem andthenstill at the end what you get is are theresults ranked by what is most relevantor based on those rules as opposed toyou know an AI first approach wherewe've got relevance because weunderstand the search intent we knowwhat people are trying to do based uponexamined human behavior from the pastwe start ranking them based on the mostlikelihood of purchaseand then we use personalization AI tomake sure that it's actually tailoredfor that individual shopperwhich then allows us to figure outhow do we learn over time so the AIcurates itself and it learns from itsmistakes it's self-testing andself-optimizingand the Holy Grail is finally to the AIsorts the pro the products to maximizeyour revenues rightso let's go a little bit into browse sobrowse is you know I don't want to do asearch I already know the category Iwant and I go you know pants slash likeI just go into pantssince we understand the user we optimizethe way in which we show the products topersonalize it and to optimize ourconversion rates rightthen there is the other part which isyou if you go to a site you'll see allthe filters I want to filter by brand Iwant to filter by size I want to filterby colorthe these are core facets and the facetsare actually determined by the retailerhowever we can use machine learning andour AI to figure outoops I didn't want to do that how do wemake sure that weshow the values for the facts forexample of assets size would have smallmedium large extra large we want to showyou the ones that are most commonly inuse for that query and for that user andwe dynamically order the facets baseduponwhich ones are most often clicked rightso that way it gives a much moreseamless experience to the the end usernow we talked a little bit about thedifferent AI models and how they allowus to understand user intent and to beable to rank all the products based uponexpected revenues but there's alsodifferent levels at which you canintegrate into Discovery AI you don'thave to go all the way from zero to youknow fifth gear on day one and so youcan graduate yourself and in order toshow how this works in the product wehave our product manager Noah whounfortunately couldn't be here who'sgoing to have a little bit of a a Dem ashow of the product and speak throughthe some of the things which we've doneto make it easy for us to integrate intothe different tiers of the AIhi everyone I'm Noah Freeman I'm thehead of product for cloud retail searchthis product and while I can't join youin person I wanted to take this to anopportunity to demonstrate two newfeatures that sort of show you how theproduct works and that we've also justreleased the first is our Auto upgradesystem where the model operates in oneof four modes and those four modes arerelevance only where it sorts productsusing Google shopping relevance indescending order of relevance then ithas relevance plus popularity whichlooks like relevance mode except that itbreaks ties for better selling productsthen there's Revenue optimized modewhich is revenue I expected Revenueranking that we've discussed and thenthe last upgrade is to personalizedRevenue optimized mode where it alsoenables personalizationand this dashboard lets you see whichmode you're inand the model will also Auto upgrade tothe best mode it has the right data forand so you can see where it is and thenwhat this module also gives you is theability to see what data is blockingyour upgrade to the next mode so you canas a user not only has to understandwhat mode you're in but what data fixesyou need to put in place to get to thebetter notes andum while it will work great in any ofthe modes the performances by far thebest in mode three and four and so oneof the things we spent a lot of timewith with our clients who on board ishelping them patch the data qualitychecks so that they can get to at leastmode three where the giant Revenueperformance typically comes outso I'm sure Noah wasn'ttoo happy not to be here but he hadother things that he had to take care ofum so with Discovery AIyou know we talked about some of thechallenges as you know retailers havemaking sure that we provide the rightkind of experience to really end in apurchase and maximizing RevenueDiscovery AI helps navigate through manyof those challenges informed throughGoogle shoppingtoreallyuplift some of the key metrics but ifyou see some of the metrics there thatshows averages across our customers butthe one that you need to pay attentionto is revenue per visit that's reallyyou know the what you're trying tooptimize for because you're anytimesomeone comes to your site you want toreally maximize that revenue and how dowe do thatit's through all of the understanding ofor the query and search intent we reallyavoid the you know the catastrophicscenario of abandoned searches becausethat could have a huge drag on yourRevenue potentialand on top of that by ranking them basedon you know the mostexpected revenue and personalizing thatexperience you're really seeing thesekinds of you know uplifts that acrosscustomersokay so that was a little bit of a peekunder the hood with all of the differentmodels that we havenow typically in next we've always beenabout what is in the productbut we're really excited about some ofthe work we're doing right now in llansI mean I think we've run a few Pilotsacross some of a few select customersand we're seeing some really greatresults of course there's a lot of workto be done there's a lot of work to bedone to make sure that these Generallies Beyond those people that we'reworking with andcan we really meet the you know theconstraints of latency for having theseelements in place because as you knowthe llms can be a little slowso again when you think about llms thefirst thing that comes to mind isgenerative AIand they're really good at it is imaginethat you have a really smart studentwho's read every book in the world andin every language so they have a prettygood understanding of what humans wantto do or how they speak or how theycreateso if you were to go in and use you knowan LM to say complete the sentence forme I fed my black blankit's going to come back and say you knowthere's a pretty good chance that it'scat and maybe it's a dog but definitelynot a helicopter rightmaybe right it may be wrong but that'syou know it's probabilisticbut that's not the only way we can usellans llms can be used as regressionalelements or we call them you knowrelevance grading lnnyou can ask the question like heydoes a yellow Acme roofing hammerwhat is this relevance to a contractor'shammer and the relevance gradingelements come back and says oh it's 95percentit's relevant so you know that's so theoutput of a relevance grading llm is anumber as opposed to text audio orimagesso you can go try this out by the way ifyou go to Bard and ask these kinds ofquestions that we asked them said heyyellow Acme roofing hammer is that ahammerand it says yes 100. it's not acontractor's camera this goes mostlikely yes it's like 95 percentand then I ask it can I get a hammer asa gift for my child and it goes not sucha great idea right it's probably like 20unless I have a very you know wellcoordinated kid who really lovesbuildings things it's likely thathammer for a kid as a gift isn't reallya good idea and then you ask it thequestion thing of like how about like acouple that's getting married who arehobbyists can I get a ACME yellowroofing hammer as a wedding present likeno not a good idea at all but if theywere hobbies and I said yellow acne gluegun that's a pretty good number it says90 so you know it's it's using craftsand maybe there are crafting couplesit's actually a reasonably good idea soyou can do this today with bardexcept we're not going to be using Bartfor our retail search obviously we wantto be able to return results in a in ameaningful time latency in inmillisecondwithout you know really melting theserver Farmsowhat are some of the ways that we'rethinking ofusing relevance grading llms in our inour solution the first step is you canyou recall like you know things from thecatalog you get products in the catalogyou have the query and you're trying tofigure out how do youcalculate relevanceso in the relevance gradingwe could use llms in the relevancegrading right and say we can use therelevance grades and then teach all thesystems Downstream to use that betterrelevance to provide better ranking andtherefore maximize the revenueor we could take a slightly differentapproachwe could embed that relevance llm insideof the revenue grading and says is thissomething that is going to maximize yourrevenue is this something that's a goodidea to show if I were to show this itemat the top of the list what is theprobability of getting revenue for itand therefore how much revenue will Iget based on the product price and thenI can get moregranular and better estimates of therevenues as estimates in the finalranking and therefore still improve yourfinal ranking so there's a couple ofmolds in which we're experimenting inwe're workingum as I mentioned before we're workingwith a few select customers on pilotsand we've been really astonished at theresults again it's very earlyumwe still have to make sure that thisapproach is feasible from a computeinfrastructure perspective from alatency perspective from a userexperience perspective and that isgeneralizable across multiple retailerssotheum so the idea is like we're going tocontinue to work on this and we'll seehow things progress and hopefully we'llbe hearing more from us soonso withwith that I want to bookend this thissession with some of our key customerswho've been able to deploy Discovery AIin their retail sites and see what kindof experience that they've hadso Shopify has beenmaking Discovery ai ai available to allof their Enterprise customers across theglobe in multiple languages right so Ithink it's a pretty difficult thing todo in traditional systems because youthen have to think about translatingqueries you you can just translate appleto Palm in French ifit is if it's unless it's an Apple Watchright so there are there are a bunch ofthings that you have to think about sothey've brought this to to all of theirEnterprise customers globallyum fnac darty is a multi-branded Frenchretailer that had a problem with areally really large catalog about 20million products and trying to sell thisacross multiple brands in differentlanguages throughout Europe and they'restarting to use Discovery Ai and rollout to the multiple retailers that theyhaveLowe's has been one of our earliestcustomers one of their biggestchallenges was abandoned queries becausepeople would use bespoke Search termsand they would end up seeing almost 5015 of their searches being abandoned sonow with after using you know betterrelevance and better query intentDiscerning they're able to capture a lotmore of the market share by not havingno search results found kinds ofAbandonment abandonmentand Macy's is also one of our earlycustomers and they've been usingDiscovery AI to improve their Shoppersexperience on their digital propertiesnow hopefully all of this has given youa little sense of the kinds of thingsthatwe can do in terms of retail search andproduct Discovery and while the wholeshopping journey is still the same withthe same different steps each of thosesteps are evolving rapidly andgiven our experience with Googleshopping it's been informing a lot ofwhat customers really are looking forthat we can bring to retailers and bycontinually working on our AI models tomake sure that we optimize on theexpected Revenue we are able to delivervalue to all of our customers"
}